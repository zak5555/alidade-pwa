window.ICONS = {
    menu: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>`,
    settings: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>`,
    close: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>`,
    back: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5"/><path d="M12 19l-7-7 7-7"/></svg>`,
    arrowLeft: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
    </svg>`,
    location: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>`,
    search: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>`,
    filter: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon></svg>`,
    star: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>`,
    share: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line></svg>`,
    download: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/></svg>`,
    externalLink: `<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/></svg>`,
    market: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>`,
    defense: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>`,
    intel: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>`,
    lock: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/></svg>`,
    unlock: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 11V7a4 4 0 118 0m-4 8v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z"/></svg>`,
    map: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l5.447 2.724A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"/></svg>`,
    signal: `<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>`,
    heart: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/></svg>`,
    userShield: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/></svg>`,
    hashtag: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14"/></svg>`,
    calculator: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"/></svg>`,
    phone: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/></svg>`,
    mic: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" /></svg>`,
    alert: `<svg class="w-16 h-16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/></svg>`,
    chevronDown: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>`,
    beaker: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"/></svg>`,
    cube: `<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/></svg>`,
    checkCircle: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>`,
    xCircle: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>`
};

/**
 * ALIDADE STATIC CONSTANTS
 * Extracted from app.js for better maintainability.
 */

window.MARRAKECH_CONSTANTS = {
    // Marrakech coordinates for sunset calculation
    LAT: 31.6295,
    LNG: -7.9811,

    // Souk operating hours (shops typically close ~8-9 PM)
    SOUK_OPEN_HOUR: 9,
    SOUK_CLOSE_HOUR: 20,

    // Peak tourist hours (highest markup)
    PEAK_HOURS: [10, 11, 14, 15, 16],
    OFF_PEAK_HOURS: [9, 12, 13, 18, 19],

    // Tourist seasons (markup multiplier)
    HIGH_SEASON_MONTHS: [3, 4, 10, 11, 12], // March-April, Oct-Dec
    LOW_SEASON_MONTHS: [1, 6, 7, 8], // Jan, June-Aug (too hot)

    // Day of week impact (Friday = holy day, less commerce)
    WEEKEND_DAYS: [5, 6], // Friday, Saturday

    // Item category markups (typical tourist markup)
    ITEM_MARKUPS: {
        leather: { markup: 3.5, touristItem: true, volatility: 0.3 },
        ceramics: { markup: 3.0, touristItem: true, volatility: 0.25 },
        spices: { markup: 2.5, touristItem: true, volatility: 0.2 },
        rugs: { markup: 4.0, touristItem: true, volatility: 0.4 },
        textiles: { markup: 2.8, touristItem: true, volatility: 0.25 },
        jewelry: { markup: 3.5, touristItem: true, volatility: 0.35 },
        lamps: { markup: 3.2, touristItem: true, volatility: 0.3 },
        art: { markup: 4.0, touristItem: false, volatility: 0.5 },
        antiques: { markup: 5.0, touristItem: false, volatility: 0.6 },
        food: { markup: 1.5, touristItem: false, volatility: 0.1 },
        other: { markup: 2.5, touristItem: true, volatility: 0.3 }
    },

    // Souk area characteristics
    SOUK_AREAS: {
        jemaa: {
            touristDensity: 0.95,
            competition: 0.4,
            avgMarkup: 4.0,
            description: 'Main square - highest tourist traffic'
        },
        medina: {
            touristDensity: 0.7,
            competition: 0.8,
            avgMarkup: 2.8,
            description: 'Deep souk - more competition, better deals'
        },
        mellah: {
            touristDensity: 0.5,
            competition: 0.6,
            avgMarkup: 2.5,
            description: 'Jewish quarter - less touristy, authentic'
        },
        gueliz: {
            touristDensity: 0.3,
            competition: 0.3,
            avgMarkup: 1.8,
            description: 'Modern area - fixed prices more common'
        },
        unknown: {
            touristDensity: 0.6,
            competition: 0.5,
            avgMarkup: 3.0,
            description: 'Default souk area'
        }
    }
};

window.CURRENCY_CONFIG = {
    MAD: { code: 'MAD', name: 'Moroccan Dirham', symbol: 'DH', flag: 'ðŸ‡²ðŸ‡¦' },
    USD: { code: 'USD', name: 'US Dollar', symbol: '$', flag: 'ðŸ‡ºðŸ‡¸' },
    EUR: { code: 'EUR', name: 'Euro', symbol: 'â‚¬', flag: 'ðŸ‡ªðŸ‡º' },
    GBP: { code: 'GBP', name: 'British Pound', symbol: 'Â£', flag: 'ðŸ‡¬ðŸ‡§' },
    JPY: { code: 'JPY', name: 'Japanese Yen', symbol: 'Â¥', flag: 'ðŸ‡¯ðŸ‡µ' },
    CNY: { code: 'CNY', name: 'Chinese Yuan', symbol: 'Â¥', flag: 'ðŸ‡¨ðŸ‡³' },
    AUD: { code: 'AUD', name: 'Australian Dollar', symbol: 'A$', flag: 'ðŸ‡¦ðŸ‡º' },
    CAD: { code: 'CAD', name: 'Canadian Dollar', symbol: 'C$', flag: 'ðŸ‡¨ðŸ‡¦' },
    CHF: { code: 'CHF', name: 'Swiss Franc', symbol: 'CHF', flag: 'ðŸ‡¨ðŸ‡­' }
};

window.FALLBACK_RATES = {
    USD: 0.098,  // 1 MAD = ~$0.098
    EUR: 0.091,  // 1 MAD = ~â‚¬0.091
    GBP: 0.078,  // 1 MAD = ~Â£0.078
    JPY: 14.5,   // 1 MAD = ~Â¥14.5
    CNY: 0.71,   // 1 MAD = ~Â¥0.71
    AUD: 0.155,  // 1 MAD = ~A$0.155
    CAD: 0.139,  // 1 MAD = ~C$0.139
    CHF: 0.088   // 1 MAD = ~CHF 0.088
};

window.ARABIC_PHRASES = {
    greetings: [
        { id: 'g01', arabic: 'Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ…', darija: 'salam alaykoum', phonetic: 'sa-LAM a-LAY-koom', english: 'Peace be upon you', audio: 'assets/audio/greetings_salam.mp3', difficulty: 'easy', tips: 'Most respectful greeting. Use when entering shops.', gender: 'neutral' },
        { id: 'g02', arabic: 'ØµØ¨Ø§Ø­ Ø§Ù„Ø®ÙŠØ±', darija: 'sbah lkhir', phonetic: 'SBAH l-KHEER', english: 'Good morning', audio: 'assets/audio/greetings_sbah.mp3', difficulty: 'easy', tips: 'Use before noon. Friendly opener.', gender: 'neutral' },
        { id: 'g03', arabic: 'Ù…Ø³Ø§Ø¡ Ø§Ù„Ø®ÙŠØ±', darija: 'msa lkhir', phonetic: 'MSA l-KHEER', english: 'Good evening', audio: 'assets/audio/greetings_msa.mp3', difficulty: 'easy', tips: 'Use after sunset.', gender: 'neutral' },
        { id: 'g04', arabic: 'Ø´ÙƒØ±Ø§', darija: 'shukran', phonetic: 'SHUK-ran', english: 'Thank you', audio: 'assets/audio/la_shukran.mp3', difficulty: 'easy', tips: 'Basic politeness. Use often!', gender: 'neutral' },
        { id: 'g05', arabic: 'Ø¹ÙÙˆØ§', darija: 'afwan', phonetic: 'AF-wan', english: "You're welcome", audio: 'assets/audio/greetings_afwan.mp3', difficulty: 'easy', tips: 'Response to shukran.', gender: 'neutral' },
        { id: 'g06', arabic: 'Ù„Ø§ Ø´ÙƒØ±Ø§', darija: 'la shukran', phonetic: 'LA SHUK-ran', english: 'No thank you', audio: 'assets/audio/la_shukran.mp3', difficulty: 'easy', tips: 'Polite but firm refusal.', gender: 'neutral' },
        { id: 'g07', arabic: 'Ø§Ù„Ù„Ù‡ ÙŠØ³Ù‡Ù„', darija: 'allah ysahel', phonetic: 'AL-lah y-SA-hel', english: 'May God make it easy', audio: 'assets/audio/allah_ysahel.mp3', difficulty: 'medium', tips: 'Blessing phrase. Shows cultural respect.', gender: 'neutral' },
        { id: 'g08', arabic: 'Ø£Ù†Ø§ ÙØ§Ù‡Ù…', darija: 'ana fahem', phonetic: 'A-na FA-hem', english: 'I understand', audio: 'assets/audio/anafahem.mp3', difficulty: 'easy', tips: 'Use to confirm comprehension.', gender: 'male' },
        { id: 'g09', arabic: 'Ø¨Ø³Ù„Ø§Ù…Ø©', darija: 'bslama', phonetic: 'b-SLA-ma', english: 'Goodbye', audio: 'assets/audio/greetings_bslama.mp3', difficulty: 'easy', tips: 'Casual farewell.', gender: 'neutral' },
        { id: 'g10', arabic: 'ÙƒÙŠÙ Ø¯Ø§ÙŠØ±ØŸ', darija: 'kif dayr?', phonetic: 'KEEF DAY-er', english: 'How are you?', audio: 'assets/audio/greetings_kifdayr.mp3', difficulty: 'easy', tips: 'Male form. Female: kif dayra?', gender: 'male' }
    ],
    shopping: [
        { id: 's01', arabic: 'Ø¨Ø´Ø­Ø§Ù„ØŸ', darija: 'bchhal?', phonetic: 'b-CHHAL', english: 'How much?', audio: 'assets/audio/shopping_bchhal.mp3', difficulty: 'easy', tips: 'Essential! Use for everything.', gender: 'neutral' },
        { id: 's02', arabic: 'ØºØ§Ù„ÙŠ Ø¨Ø²Ø§Ù', darija: 'ghali bezaf', phonetic: 'GHA-li b-ZAF', english: 'Too expensive', audio: 'assets/audio/ghali_bezaf.mp3', difficulty: 'easy', tips: 'Your secret weapon. Act shocked!', gender: 'neutral' },
        { id: 's03', arabic: 'Ù†Ù‚Øµ Ø´ÙˆÙŠØ©', darija: 'nqas shwiya', phonetic: 'n-KAS SHWEE-ya', english: 'Reduce a little', audio: 'assets/audio/nqas_shwiya.mp3', difficulty: 'medium', tips: 'Polite way to ask for discount.', gender: 'neutral' },
        { id: 's04', arabic: 'Ø¢Ø®Ø± Ø«Ù…Ù†ØŸ', darija: 'akhir taman?', phonetic: 'A-khir ta-MAN', english: 'Last price?', audio: 'assets/audio/akhir_taman.mp3', difficulty: 'medium', tips: 'Ask this to get final offer.', gender: 'neutral' },
        { id: 's05', arabic: 'Ù…Ø§ Ø¨ØºÙŠØª ÙˆØ§Ù„Ùˆ', darija: 'ma bghit walo', phonetic: 'ma BGHIT WA-lo', english: "I don't want anything", audio: 'assets/audio/mabghit_walo.mp3', difficulty: 'medium', tips: 'Firm but polite exit.', gender: 'neutral' },
        { id: 's06', arabic: 'Ø¨Ù„Ø§Ø´', darija: 'blach', phonetic: 'BLASH', english: 'No way / Forget it', audio: 'assets/audio/blach.mp3', difficulty: 'easy', tips: 'Casual rejection. Keep walking.', gender: 'neutral' },
        { id: 's07', arabic: 'Ù„Ø§ ØµØ§ÙÙŠ', darija: 'la safi', phonetic: 'LA SA-fee', english: "No, that's enough", audio: 'assets/audio/la_safi.mp3', difficulty: 'easy', tips: 'End the negotiation firmly.', gender: 'neutral' },
        { id: 's08', arabic: 'Ù‡Ø°Ø§ Ù…Ø²ÙˆØ±', darija: 'hada mzawer', phonetic: 'HA-da m-ZA-wer', english: 'This is fake', audio: 'assets/audio/hada_mzawer.mp3', difficulty: 'medium', tips: 'Call out counterfeit goods.', gender: 'neutral' },
        { id: 's09', arabic: 'Ù…Ø§Ø´ÙŠ Ø£ÙˆØ±Ùˆ', darija: 'machi euro', phonetic: 'MA-shi EU-ro', english: "I don't pay in euros", audio: 'assets/audio/machi_euro.mp3', difficulty: 'easy', tips: 'Insist on MAD pricing.', gender: 'neutral' },
        { id: 's10', arabic: 'Ù‡Ø§ 200 Ø¯Ø±Ù‡Ù…', darija: 'ha 200 dirham', phonetic: 'HA mya-TAYN dir-HAM', english: 'Here is 200 dirhams', audio: 'assets/audio/ha_200dh.mp3', difficulty: 'medium', tips: 'Making a counteroffer.', gender: 'neutral' },
        { id: 's11', arabic: 'Ù…Ø§Ø´ÙŠ ØªÙˆØ±ÙŠØ³Øª', darija: 'mashi tourist', phonetic: 'MA-shi too-RIST', english: "I'm not a tourist", audio: 'assets/audio/mashi_tourist.mp3', difficulty: 'easy', tips: 'Claim local status for fairer prices.', gender: 'neutral' },
        { id: 's12', arabic: 'Ø£Ù†Ø§ Ø³Ø§ÙƒÙ† Ù‡Ù†Ø§', darija: 'ana saken hna', phonetic: 'A-na SA-ken HNA', english: 'I live here', audio: 'assets/audio/ana_saken_hna.mp3', difficulty: 'medium', tips: 'Supports your local claim.', gender: 'male' },
        { id: 's13', arabic: 'Ø³ÙŠØ± Ø¨Ø­Ø§Ù„Ùƒ', darija: 'sir b7alak', phonetic: 'SEER b-HA-lak', english: 'Go away / Leave me alone', audio: 'assets/audio/sir_b7alak.mp3', difficulty: 'medium', tips: 'Firm dismissal. Use if harassed.', gender: 'neutral' },
        { id: 's14', arabic: 'Ù…Ø§ Ø·Ù„Ø¨ØªØ´ Ù‡Ø§Ø¯Ø´ÙŠ', darija: "ma tlabtch hadchi", phonetic: 'ma t-LABT-ch HAD-chi', english: "I didn't order this", audio: 'assets/audio/matlabtch_hadchi.mp3', difficulty: 'hard', tips: 'Refuse unwanted items.', gender: 'neutral' },
        { id: 's15', arabic: 'ÙˆØ§Ø®Ø§ ØºØ§Ø¯ÙŠ Ù†Ø§Ø®Ø¯Ùˆ', darija: 'wakha ghadi nakhdou', phonetic: 'WA-kha GHA-di NAKH-dou', english: "OK, I'll take it", audio: 'assets/audio/shopping_wakha.mp3', difficulty: 'medium', tips: 'Accept the deal.', gender: 'neutral' }
    ],
    directions: [
        { id: 'd01', arabic: 'ÙÙŠÙ†ØŸ', darija: 'fin?', phonetic: 'FEEN', english: 'Where?', audio: 'assets/audio/directions_fin.mp3', difficulty: 'easy', tips: 'Start of any direction question.', gender: 'neutral' },
        { id: 'd02', arabic: 'ÙÙŠÙ† ÙƒØ§ÙŠÙ†...ØŸ', darija: 'fin kayn...?', phonetic: 'FEEN KAY-en', english: 'Where is...?', audio: 'assets/audio/directions_finkayn.mp3', difficulty: 'easy', tips: 'Add place name after.', gender: 'neutral' },
        { id: 'd03', arabic: 'Ù„ÙŠÙ…Ù†', darija: 'lymen', phonetic: 'l-YE-men', english: 'Right', audio: 'assets/audio/directions_lymen.mp3', difficulty: 'easy', tips: 'Turn right.', gender: 'neutral' },
        { id: 'd04', arabic: 'Ù„ÙŠØ³Ø±', darija: 'lysar', phonetic: 'l-YE-sar', english: 'Left', audio: 'assets/audio/directions_lysar.mp3', difficulty: 'easy', tips: 'Turn left.', gender: 'neutral' },
        { id: 'd05', arabic: 'Ù†ÙŠØ´Ø§Ù†', darija: 'nishan', phonetic: 'NEE-shan', english: 'Straight', audio: 'assets/audio/directions_nishan.mp3', difficulty: 'easy', tips: 'Go straight ahead.', gender: 'neutral' },
        { id: 'd06', arabic: 'Ù‚Ø±ÙŠØ¨', darija: 'qrib', phonetic: 'KREEB', english: 'Near/Close', audio: 'assets/audio/directions_qrib.mp3', difficulty: 'easy', tips: 'It is close by.', gender: 'neutral' },
        { id: 'd07', arabic: 'Ø¨Ø¹ÙŠØ¯', darija: "b3id", phonetic: 'B-EED', english: 'Far', audio: 'assets/audio/directions_b3id.mp3', difficulty: 'easy', tips: 'It is far away.', gender: 'neutral' },
        { id: 'd08', arabic: 'ÙÙŠÙ† Ø¬Ø§Ù…Ø¹ Ø§Ù„ÙÙ†Ø§ØŸ', darija: 'fin jama3 lfna?', phonetic: 'FEEN ja-MA l-FNA', english: 'Where is Jemaa el-Fnaa?', audio: 'assets/audio/directions_jemaa.mp3', difficulty: 'medium', tips: 'The main square.', gender: 'neutral' },
        { id: 'd09', arabic: 'ÙÙŠÙ† Ø§Ù„Ø±ÙŠØ§Ø¶ØŸ', darija: 'fin riad?', phonetic: 'FEEN ree-YAD', english: 'Where is the riad?', audio: 'assets/audio/directions_riad.mp3', difficulty: 'easy', tips: 'Find your accommodation.', gender: 'neutral' },
        { id: 'd10', arabic: 'ÙˆØ§Ø´ Ø¨Ø¹ÙŠØ¯ Ù…Ù† Ù‡Ù†Ø§ØŸ', darija: 'wach b3id mn hna?', phonetic: 'WASH B-EED mn HNA', english: 'Is it far from here?', audio: 'assets/audio/directions_wachb3id.mp3', difficulty: 'medium', tips: 'Check distance before walking.', gender: 'neutral' }
    ],
    numbers: [
        { id: 'n01', arabic: 'Ø¹Ø´Ø±Ø©', darija: '3achra', phonetic: 'AASH-ra', english: '10 (ten)', audio: 'assets/audio/numbers_10.mp3', difficulty: 'easy', tips: 'Ten dirhams.', gender: 'neutral' },
        { id: 'n02', arabic: 'Ø¹Ø´Ø±ÙŠÙ†', darija: '3chrin', phonetic: 'AASH-reen', english: '20 (twenty)', audio: 'assets/audio/numbers_20.mp3', difficulty: 'easy', tips: 'Twenty dirhams.', gender: 'neutral' },
        { id: 'n03', arabic: 'Ø®Ù…Ø³ÙŠÙ†', darija: 'khamsin', phonetic: 'KHAM-seen', english: '50 (fifty)', audio: 'assets/audio/numbers_50.mp3', difficulty: 'easy', tips: 'Fifty dirhams.', gender: 'neutral' },
        { id: 'n04', arabic: 'Ù…ÙŠØ©', darija: 'mya', phonetic: 'MEE-ya', english: '100 (hundred)', audio: 'assets/audio/numbers_100.mp3', difficulty: 'easy', tips: 'One hundred dirhams.', gender: 'neutral' },
        { id: 'n05', arabic: 'Ù…ÙŠØªÙŠÙ†', darija: 'myatayn', phonetic: 'mya-TAYN', english: '200 (two hundred)', audio: 'assets/audio/numbers_200.mp3', difficulty: 'medium', tips: 'Two hundred dirhams.', gender: 'neutral' },
        { id: 'n06', arabic: 'Ø®Ù…Ø³ Ù…ÙŠØ©', darija: 'khams mya', phonetic: 'KHAMS MEE-ya', english: '500 (five hundred)', audio: 'assets/audio/numbers_500.mp3', difficulty: 'medium', tips: 'Five hundred dirhams.', gender: 'neutral' },
        { id: 'n07', arabic: 'Ø£Ù„Ù', darija: 'alf', phonetic: 'ALF', english: '1000 (thousand)', audio: 'assets/audio/numbers_1000.mp3', difficulty: 'easy', tips: 'One thousand dirhams.', gender: 'neutral' },
        { id: 'n08', arabic: 'ÙˆØ§Ø­Ø¯', darija: 'wahed', phonetic: 'WA-hed', english: '1 (one)', audio: 'assets/audio/numbers_1.mp3', difficulty: 'easy', tips: 'One item.', gender: 'neutral' },
        { id: 'n09', arabic: 'Ø¬ÙˆØ¬', darija: 'jouj', phonetic: 'JOOJ', english: '2 (two)', audio: 'assets/audio/numbers_2.mp3', difficulty: 'easy', tips: 'Two items.', gender: 'neutral' },
        { id: 'n10', arabic: 'ØªÙ„Ø§ØªØ©', darija: 'tlata', phonetic: 'TLA-ta', english: '3 (three)', audio: 'assets/audio/numbers_3.mp3', difficulty: 'easy', tips: 'Three items.', gender: 'neutral' }
    ],
    emergency: [
        { id: 'e01', arabic: 'Ø¹Ø§ÙˆÙ†ÙˆÙ†ÙŠ', darija: '3awnuni', phonetic: 'AAW-noo-nee', english: 'Help me!', audio: 'assets/audio/emergency_3awnuni.mp3', difficulty: 'medium', tips: 'Shout if in danger.', gender: 'neutral' },
        { id: 'e02', arabic: 'Ø§Ù„Ø¨ÙˆÙ„ÙŠØ³', darija: 'lbulis', phonetic: 'l-boo-LEES', english: 'Police', audio: 'assets/audio/police.mp3', difficulty: 'easy', tips: 'Call for police.', gender: 'neutral' },
        { id: 'e03', arabic: 'Ù†Ø¹ÙŠØ· Ù„Ù„Ø¨ÙˆÙ„ÙŠØ³', darija: "n3ayat l'police", phonetic: "n-AY-yat l-po-LEES", english: "I'll call the police", audio: 'assets/audio/n3ayat_poulice.mp3', difficulty: 'medium', tips: 'Threat to discourage trouble.', gender: 'neutral' },
        { id: 'e04', arabic: 'Ø³Ø¨ÙŠØ·Ø§Ø±', darija: 'sbitar', phonetic: 'sbee-TAR', english: 'Hospital', audio: 'assets/audio/emergency_sbitar.mp3', difficulty: 'easy', tips: 'Medical emergency.', gender: 'neutral' },
        { id: 'e05', arabic: 'Ø­Ø´ÙˆÙ…Ø©', darija: 'hshuma', phonetic: 'h-SHOO-ma', english: "Shame on you!", audio: 'assets/audio/hshuma.mp3', difficulty: 'easy', tips: 'Powerful cultural shaming.', gender: 'neutral' },
        { id: 'e06', arabic: 'Ø£Ù†Ø§ Ø¹Ø§Ø±Ù Ø§Ù„Ø³ØªØ§Ù', darija: 'ana 3araf staff', phonetic: 'A-na AA-raf STAFF', english: 'I know the staff here', audio: 'assets/audio/ana_3araf_staff.mp3', difficulty: 'medium', tips: 'Claim insider status.', gender: 'male' },
        { id: 'e07', arabic: 'Ø®Ø¯Ù‘Ø§Ù… ÙÙŠ Ø§Ù„Ø¨ÙŠØ³ÙŠ', darija: 'khadam computer', phonetic: 'KHA-dam kom-PYOO-ter', english: 'I work on computers', audio: 'assets/audio/khadam_compteure.mp3', difficulty: 'medium', tips: 'Explain your job (generic).', gender: 'male' }
    ],
    food: [
        { id: 'f01', arabic: 'Ø¹ØµÙŠØ±', darija: '3assir', phonetic: 'AA-seer', english: 'Juice', audio: 'assets/audio/3assir.mp3', difficulty: 'easy', tips: 'Fresh orange juice is famous!', gender: 'neutral' },
        { id: 'f02', arabic: 'Ù‡Ù…Ø²Ø©', darija: 'hemza', phonetic: 'HEM-za', english: 'Hemza (name/bread roll)', audio: 'assets/audio/hemza.mp3', difficulty: 'easy', tips: 'Common bread roll type.', gender: 'neutral' },
        { id: 'f03', arabic: 'Ø£ØªØ§ÙŠ', darija: 'atay', phonetic: 'a-TAY', english: 'Mint tea', audio: 'assets/audio/food_atay.mp3', difficulty: 'easy', tips: 'National drink. Never refuse!', gender: 'neutral' },
        { id: 'f04', arabic: 'Ø®Ø¨Ø²', darija: 'khobz', phonetic: 'KHOBZ', english: 'Bread', audio: 'assets/audio/food_khobz.mp3', difficulty: 'easy', tips: 'Moroccan flatbread.', gender: 'neutral' },
        { id: 'f05', arabic: 'Ù…Ø§', darija: 'ma', phonetic: 'MA', english: 'Water', audio: 'assets/audio/food_ma.mp3', difficulty: 'easy', tips: 'Ask for bottled water.', gender: 'neutral' },
        { id: 'f06', arabic: 'Ø·Ø§Ø¬ÙŠÙ†', darija: 'tajin', phonetic: 'ta-JEEN', english: 'Tagine (dish)', audio: 'assets/audio/food_tajin.mp3', difficulty: 'easy', tips: 'Traditional slow-cooked stew.', gender: 'neutral' }
    ]
};

window.THREAT_DATA = [
    // --- JEMAA EL FNA ---
    {
        id: "monkey_snake_ambush",
        category: "jemaa",
        title: "Monkey/Snake Ambush",
        risk: "HIGH",
        loss: "100-500 DH",
        description: "â€¢ The Ambush: They put a snake/monkey on your shoulder suddenly.\nâ€¢ The Extortion: They demand 200-300 DH to remove it or for the photo.",
        counter_measure: "â€¢ The 2-Meter Rule: Keep a safe distance. If they approach, raise your hand and yell 'NO'.\nâ€¢ Price Lock: Never take a photo without agreeing on 10-20 DH total beforehand.",
        verbal_nuke: {
            phrase: "Sir Fhal-ek",
            phonetic: "Sir Fhal-ek",
            meaning: "Go Away",
            audio: "assets/audio/sir_b7alak.mp3"
        }
    },
    {
        id: "orange_juice_roulette",
        category: "jemaa",
        title: "Orange Juice Roulette",
        risk: "HIGH",
        loss: "<50 DH",
        description: "â€¢ The Mix: Some carts dilute juice with tap water or sugar water.\nâ€¢ The Ice: Huge amounts of ice made from tap water (stomach issues).",
        counter_measure: "â€¢ The Phrase: Always order 'Sans GlaÃ§on' (No Ice).\nâ€¢ Observation: Watch them squeeze oranges in front of you.\nâ€¢ Safe Stall: Stall #40 has a good reputation.",
        verbal_nuke: {
            phrase: "L-3assir Bou-hdou",
            phonetic: "L-3a-ssir Bou-hdou",
            meaning: "Just Orange (No mix)",
            audio: "assets/audio/3assir.mp3"
        }
    },
    {
        id: "the_henna_grab",
        category: "jemaa",
        title: "The Henna Grab",
        risk: "HIGH",
        loss: "100-500 DH",
        description: "â€¢ The Ambush: Women with syringes grab your hand and start drawing immediately.\nâ€¢ The Poison: 'Black Henna' often contains PPD (toxic chemical, causes burns).",
        counter_measure: "â€¢ Body Shield: Keep hands in pockets. No hands = No target.\nâ€¢ Action: Pull away instantly and forcefully.",
        verbal_nuke: {
            phrase: "La chok-ran",
            phonetic: "La chok-ran",
            meaning: "No Thanks",
            audio: "assets/audio/la_shukran.mp3"
        }
    },

    // --- RESTAURANTS ---
    {
        id: "billShockStandoff",
        category: "restaurants",
        title: "Bill Shock Standoff",
        risk: "HIGH",
        loss: "600+ DH",
        description: "â€¢ The Shock: Bill is 3x or 4x expected.\nâ€¢ The Swarm: Waiters gather to intimidate you.\nâ€¢ Goal: Make you pay to escape.",
        counter_measure: "â€¢ Evidence: Show menu photo taken earlier.\nâ€¢ Calc: Do math visibly.\nâ€¢ Power Move: Put EXACT FAIR AMOUNT on table and leave.",
        verbal_nuke: {
            phrase: "Ay-yet l'Boul-ice",
            phonetic: "Ay-yet l'Boul-ice",
            meaning: "Call the Police",
            audio: "assets/audio/n3ayat_poulice.mp3"
        }
    },
    {
        id: "entrapment",
        category: "restaurants",
        title: "Entrapment",
        risk: "MEDIUM",
        loss: "100-500 DH",
        description: "â€¢ They place bread, water, and olives immediately on the table (not free).",
        counter_measure: "â€¢ Immediate refusal. Say 'Blach' and gesture to return it. Don't touch it.",
        verbal_nuke: {
            phrase: "Blach",
            phonetic: "Blach",
            meaning: "No need",
            audio: "assets/audio/blach.mp3"
        }
    },
    {
        id: "phantomBillTouts",
        category: "restaurants",
        title: "Phantom Bill & Touts",
        risk: "MEDIUM",
        loss: "100-500 DH",
        description: "â€¢ Menu Tricks: 'Price per 100g' or switching menus.\nâ€¢ Bad Stalls: Avoid Stall #117 and #1.",
        counter_measure: "â€¢ Safe List: Stall #14 (Fish) or #31 (Meat).\nâ€¢ Evidence: Photo the menu before ordering.",
        verbal_nuke: {
            phrase: "Ma-talabt-sh had-shi",
            phonetic: "Ma-talabt-sh had-shi",
            meaning: "I didn't order this",
            audio: "assets/audio/matlabtch_hadchi.mp3"
        }
    },

    // --- SHOPS & SOUK ---
    {
        id: "carpetCooperative",
        category: "souk",
        title: "Carpet 'Cooperative'",
        risk: "MEDIUM",
        loss: "600+ DH",
        description: "â€¢ The Setup: Claiming to be 'Government Co-op' (Lie).\nâ€¢ The Drama: Acting insulted if you offer low price.",
        counter_measure: "â€¢ Reverse Anchoring: Ask 500? Offer 50. Reset expectations.\nâ€¢ Walk-Away: Price drops 70% when you leave.",
        verbal_nuke: {
            phrase: "Ghali Bezaf!",
            phonetic: "Gha-li Bez-zaf!",
            meaning: "Too Expensive!",
            audio: "assets/audio/ghali_bezaf.mp3"
        }
    },
    {
        id: "theMoneyMagician",
        category: "souk",
        title: "The Money Magician",
        risk: "MEDIUM",
        loss: "100-500 DH",
        description: "â€¢ Fold Under: Folding a bill underneath while counting.\nâ€¢ Calculator Trick: Switching to 'Euro' at payment.",
        counter_measure: "â€¢ Control: Count change yourself slowly.\nâ€¢ Clarity: Confirm 'Dirham?' before tapping card.",
        verbal_nuke: {
            phrase: "Machi Euro",
            phonetic: "Machi Euro",
            meaning: "Not Euro",
            audio: "assets/audio/machi_euro.mp3"
        }
    },
    {
        id: "governmentShopLie",
        category: "souk",
        title: "'Government Shop' Lie",
        risk: "MEDIUM",
        loss: "600+ DH",
        description: "â€¢ The Lie: 'Fixed Price because State-run'.\nâ€¢ Reality: NO government shops exist in Souks.",
        counter_measure: "â€¢ Action: Ignore the title. Negotiate normally or walk away.",
        verbal_nuke: {
            phrase: "Ana fa-hem",
            phonetic: "Ana fa-hem",
            meaning: "I understand (the game)",
            audio: "assets/audio/anafahem.mp3"
        }
    },
    {
        id: "theCalculatorShift",
        category: "souk",
        title: "The Calculator Shift",
        risk: "MEDIUM",
        loss: "100-500 DH",
        description: "â€¢ Trap: Screen shows '500'. He claims it's Euros or uses '00' button to shift decimal.",
        counter_measure: "â€¢ Say currency out loud and check screen.",
        verbal_nuke: {
            phrase: "Dirham, Machi Euro!",
            phonetic: "Dirham, Machi Euro!",
            meaning: "Dirham, not Euro!",
            audio: "assets/audio/machi_euro.mp3"
        }
    },
    {
        id: "theSaffronScam",
        category: "souk",
        title: "The Saffron Scam",
        risk: "MEDIUM",
        loss: "100-500 DH",
        description: "â€¢ Trap: Selling red powder/corn silk as Saffron.",
        counter_measure: "â€¢ Water Test: Real saffron turns water yellow slowly. Fake turns it red immediately.",
        verbal_nuke: {
            phrase: "Hada M-zou-wer",
            phonetic: "HA-DA M-ZOO-WER",
            meaning: "This is fake",
            audio: "assets/audio/hada_mzawer.mp3"
        }
    },
    {
        id: "fakeArgan",
        category: "souk",
        title: "Fake Argan",
        risk: "MEDIUM",
        loss: "100-500 DH",
        description: "â€¢ The Lie: Selling Culinary Oil as Cosmetic.\nâ€¢ The Fake: Veg oil mixed with scent in clear bottles (Light destroys Argan).",
        counter_measure: "â€¢ Check: Cosmetic is light gold, Culinary is dark/roasted. Must be in dark glass.",
        verbal_nuke: { phrase: null, phonetic: null, meaning: null }
    },

    // --- STREETS ---
    {
        id: "roadClosedTrap",
        category: "streets",
        title: "Road Closed Trap",
        risk: "HIGH",
        loss: "100-500 DH",
        description: "â€¢ The Lie: 'Road Closed' or 'Big Festival Today'.\nâ€¢ Goal: Make you doubt map and follow them.",
        counter_measure: "â€¢ Vector: Don't stop. Walk with speed.\nâ€¢ Sunglasses: Hide your eyes. No eye contact = No hook.",
        verbal_nuke: {
            phrase: "Ana Sa-ken Hna",
            phonetic: "Ana Sa-ken Hna",
            meaning: "I Live Here",
            audio: "assets/audio/ana_saken_hna.mp3"
        }
    },
    {
        id: "theTanneryRelay",
        category: "streets",
        title: "The Tannery Relay",
        risk: "HIGH",
        loss: "100-500 DH",
        description: "â€¢ The Relay: Passed from one guy to another.\nâ€¢ Mint Trick: Shoving mint under nose creates 'Immediate Debt'.",
        counter_measure: "â€¢ Protocol: Do NOT go alone. Only with licensed guide.",
        verbal_nuke: {
            phrase: "Ma-bghit Wa-lou",
            phonetic: "Ma-bghit Wa-lou",
            meaning: "I don't want anything",
            audio: "assets/audio/mabghit_walo.mp3"
        }
    },
    {
        id: "theMellahTrap",
        category: "streets",
        title: "The Mellah Trap",
        risk: "MEDIUM",
        loss: "<50 DH",
        description: "â€¢ Lie: 'Jewish Cemetery is closed'.\nâ€¢ Switch: Guiding you to fake 'Spice Market'.",
        counter_measure: "â€¢ Fact Check: Almost always open. Check Google Maps.",
        verbal_nuke: {
            phrase: "La, Shuk-ran",
            phonetic: "La, Shuk-ran",
            meaning: "No thanks",
            audio: "assets/audio/la_shukran.mp3"
        }
    },
    {
        id: "theHotelStaffImpostor",
        category: "streets",
        title: "Hotel Staff Impostor",
        risk: "MEDIUM",
        loss: "100-500 DH",
        description: "â€¢ Trap: Stranger claims to work at your Riad to gain trust.",
        counter_measure: "â€¢ Ask: 'Which hotel?' or 'What is my room number?'. He will freeze.",
        verbal_nuke: {
            phrase: "Ana 3aref Staff",
            phonetic: "Ana 3aref Staff",
            meaning: "I know the staff",
            audio: "assets/audio/ana_3araf_staff.mp3"
        }
    },

    // --- TRANSPORT ---
    {
        id: "theBillSwitch",
        category: "transport",
        title: "The Bill Switch",
        risk: "MEDIUM",
        loss: "100-500 DH",
        description: "â€¢ Switch: You hand 200 DH. Driver drops it, swaps for 20 DH, claims mistake.",
        counter_measure: "â€¢ Announce: 'Here is 200'.\nâ€¢ Flash: Use phone light.\nâ€¢ Photo: Take photo of bill in hand.",
        verbal_nuke: {
            phrase: "Ha Me-ten Der-ham",
            phonetic: "Ha Me-ten Der-ham",
            meaning: "Here is 200",
            audio: "assets/audio/ha_200dh.mp3"
        }
    },
    {
        id: "beforeRiding",
        category: "transport",
        title: "Meter Check",
        risk: "MEDIUM",
        loss: "100-500 DH",
        description: "â€¢ Lie: 'Meter broken' or fixed price demand.",
        counter_measure: "â€¢ Prerequisite: Say 'Turn on meter'. If refused, find another.",
        verbal_nuke: {
            phrase: "Kh-dem Comp-teur",
            phonetic: "Kh-dem Comp-teur",
            meaning: "Turn on meter",
            audio: "assets/audio/jhadam_compteure.mp3"
        }
    },
    {
        id: "noChangeTrap",
        category: "transport",
        title: "No Change Trap",
        risk: "MEDIUM",
        loss: "<50 DH",
        description: "â€¢ Trap: 'No change' for your 100/200 DH note.",
        counter_measure: "â€¢ Prepare: Always carry coins (10, 20s). Pay exact.",
        verbal_nuke: { phrase: null, phonetic: null, meaning: null }
    }
];

window.MARRAKECH_DESTINATIONS = {
    landmarks: [
        {
            id: 'dest_001',
            name: 'Jemaa el-Fnaa ðŸ•Œ',
            nameFr: 'Place Jemaa el-Fnaa',
            lat: 31.6259,
            lng: -7.9892,
            type: 'landmark',
            icon: 'ðŸ“',
            openingHours: { open: 0, close: 24 },
            visitDuration: 60,
            bestTime: 'sunset',
            crowd: { low: [[6, 10]], medium: [[10, 18]], high: [[18, 23]] },
            description: 'Main square, food stalls, snake charmers, storytellers',
            tips: 'Come at sunset for the best atmosphere. Beware of scams.'
        },
        {
            id: 'dest_002',
            name: 'Bahia Palace ðŸ°',
            nameFr: 'Palais de la Bahia',
            lat: 31.6214,
            lng: -7.9838,
            type: 'palace',
            icon: 'ðŸ°',
            openingHours: { open: 9, close: 17 },
            visitDuration: 45,
            bestTime: 'morning',
            ticketPrice: 70,
            crowd: { low: [[9, 10]], medium: [[10, 15]], high: [[15, 17]] },
            description: '19th century palace with stunning courtyards and mosaics',
            tips: 'Go early to avoid tour groups. Photography allowed.'
        },
        {
            id: 'dest_003',
            name: 'Majorelle Garden ðŸŒµ',
            nameFr: 'Jardin Majorelle',
            lat: 31.6415,
            lng: -8.0033,
            type: 'garden',
            icon: 'ðŸŒµ',
            openingHours: { open: 8, close: 18 },
            visitDuration: 90,
            bestTime: 'early_morning',
            ticketPrice: 150,
            crowd: { low: [[8, 9]], medium: [[9, 11], [15, 18]], high: [[11, 15]] },
            description: 'Cobalt blue villa, botanical garden, YSL museum',
            tips: 'Book online to skip queues. Combine with YSL museum.'
        },
        {
            id: 'dest_004',
            name: 'Koutoubia Mosque ðŸ•Œ',
            nameFr: 'MosquÃ©e Koutoubia',
            lat: 31.6238,
            lng: -7.9933,
            type: 'mosque',
            icon: 'ðŸ•Œ',
            openingHours: { open: 0, close: 24 },
            visitDuration: 20,
            bestTime: 'any',
            ticketPrice: 0,
            description: 'Iconic 12th century minaret, visible from across the city',
            tips: 'Non-Muslims cannot enter. Admire from the gardens.'
        },
        {
            id: 'dest_005',
            name: 'Saadian Tombs âš°ï¸',
            nameFr: 'Tombeaux Saadiens',
            lat: 31.6173, lng: -7.9889,
            type: 'historical',
            icon: 'âš°ï¸',
            openingHours: { open: 9, close: 17 },
            visitDuration: 45,
            bestTime: 'morning',
            ticketPrice: 70,
            priorityScore: 8,
            crowd: { low: [[9, 10]], medium: [[10, 12], [14, 17]], high: [[12, 14]] },
            queueLatency: 45, // Main Chamber bottleneck
            description: '16th century royal necropolis. Main draw: Chamber of Twelve Columns.',
            tips: 'QUEUE HACK: If line is 30+ mins, view the garden tombs (beautiful) and skip the main chamber. 09:00 sharp is essential.'
        },
        {
            id: 'dest_006',
            name: 'El Badi Palace ðŸ§±',
            nameFr: 'Palais El Badi',
            lat: 31.6189, lng: -7.9856,
            type: 'palace',
            icon: 'ðŸ§±',
            openingHours: { open: 9, close: 17 },
            visitDuration: 60,
            bestTime: 'late_afternoon',
            ticketPrice: 70,
            priorityScore: 7,
            avoidTime: [12, 16], // HIGH THERMAL EXPOSURE
            thermalRisk: 'CRITICAL',
            description: 'Vast sunken ruin. Zero shade. "Red sandstone oven."',
            tips: 'THERMAL WARNING: Do NOT visit 12-4 PM. Schedule for late afternoon when walls cast shadows. See the storks!'
        },
        {
            id: 'dest_007',
            name: 'Ben Youssef Madrasa ðŸŽ¼',
            nameFr: 'Medersa Ben Youssef',
            lat: 31.6317, lng: -7.9855,
            type: 'historical',
            icon: 'ðŸŽ¼',
            openingHours: { open: 9, close: 18 },
            visitDuration: 45,
            bestTime: 'opening',
            ticketPrice: 50,
            priorityScore: 10,
            queueLatency: 20,
            crowd: { low: [[9, 10]], medium: [[10, 12], [16, 18]], high: [[12, 16]] },
            description: 'Architectural Apex. Post-reno, it is THE premier site.',
            tips: 'CRITICAL: 09:00 AM slot ONLY for the empty courtyard shot. After 10:00, it becomes a "selfie trap." Cash for tickets.'
        },
        {
            id: 'dest_008',
            name: 'Menara Gardens ðŸŒ¿',
            nameFr: 'Jardins de la MÃ©nara',
            lat: 31.6186, lng: -8.0221,
            type: 'garden',
            icon: 'ðŸŒ¿',
            openingHours: { open: 8, close: 17 },
            visitDuration: 45,
            bestTime: 'sunset',
            ticketPrice: 0,
            priorityScore: 4, // Low value
            avoidTime: [11, 16], // HIGH THERMAL EXPOSURE
            thermalRisk: 'HIGH',
            description: 'The "Mirage". Long dusty walk (~1km) with no flowers - just olive trees.',
            tips: 'REALITY CHECK: Often underwhelming for tourists. Only visit for the iconic Atlas photo on a clear day. Le Jardin Secret is a better Medina alternative.'
        },
        {
            id: 'dest_009',
            name: 'Dar Si Said Museum ðŸŽ­',
            nameFr: 'MusÃ©e Dar Si Said',
            lat: 31.6223, lng: -7.9828,
            type: 'museum',
            icon: 'ðŸŽ­',
            openingHours: { open: 9, close: 17 },
            visitDuration: 60,
            bestTime: 'afternoon',
            ticketPrice: 30,
            priorityScore: 7,
            closedDays: ['Tuesday'], // HARD CONSTRAINT
            thermalRefuge: true,
            description: 'Hidden Gem. Comparable to Bahia but a fraction of the crowds.',
            tips: 'CLOSED TUESDAYS. The "Strategic Alternative" â€“ prioritize over Bahia if short on time.'
        },
        {
            id: 'dest_010',
            name: 'Le Jardin Secret ðŸŒ´',
            nameFr: 'Le Jardin Secret',
            lat: 31.6303, lng: -7.9865,
            type: 'garden',
            icon: 'ðŸŒ´',
            openingHours: { open: 9, close: 18 },
            visitDuration: 60,
            bestTime: 'midday',
            ticketPrice: 80,
            priorityScore: 8,
            thermalRefuge: true,
            description: 'The Medina Sanctuary. Antithesis of Majorelle: no booking, rarely crowded.',
            tips: 'THE DECOMPRESSION CHAMBER. Perfect halfway point in a souk tour. Clean toilets, rooftop cafe, shaded benches. Prioritize over Menara.'
        }
    ],
    souks: [
        {
            id: 'dest_101',
            name: 'Place des Ã‰pices (Rahba Kedima) ðŸŒ¶ï¸',
            nameFr: 'Place des Ã‰pices',
            lat: 31.6293,
            lng: -7.9868,
            type: 'souk',
            icon: 'ðŸŒ¶ï¸',
            openingHours: { open: 9, close: 20 },
            visitDuration: 45,
            bestTime: 'morning',
            priorityScore: 8,
            description: 'Spice Square. Spices, woven hats, chameleons.',
            tips: 'CafÃ© des Ã‰pices is good for a break.'
        },
        {
            id: 'dest_102',
            name: 'Souk Semmarine ðŸ›ï¸',
            lat: 31.6275,
            lng: -7.9892,
            type: 'souk',
            icon: 'ðŸ›ï¸',
            openingHours: { open: 9, close: 21 },
            visitDuration: 60,
            priorityScore: 7,
            description: 'Main artery of the souks. Touristy but impressive.',
            tips: 'Most expensive prices. Look, don\'t buy (unless you haggle hard).'
        },
        {
            id: 'dest_103',
            name: 'Souk Haddadine (Blacksmiths) ðŸ”¨',
            lat: 31.6300,
            lng: -7.9870,
            type: 'souk',
            icon: 'ðŸ”¨',
            openingHours: { open: 9, close: 19 },
            visitDuration: 30,
            description: 'Sounds of metal striking metal. Authentic vibes.',
            tips: 'Noisy and fascinating. Watch them work.'
        },
        {
            id: 'dest_104',
            name: 'Tanneries (Bab Debbagh) ðŸ‘ƒ',
            lat: 31.6345,
            lng: -7.9790,
            type: 'souk',
            icon: 'ðŸ‘ƒ',
            openingHours: { open: 9, close: 17 },
            visitDuration: 60,
            priorityScore: 5, // High scam risk
            scamRisk: 'high',
            description: 'Leather processing pits. Smell is intense.',
            tips: 'SCAM WARNING. Do not follow "guides". Pay small fee to guardian only. carry mint.'
        }
    ],
    restaurants: [
        {
            id: 'dest_200',
            name: 'Chez Chegrouni ðŸ¥˜',
            lat: 31.6262, lng: -7.9888,
            type: 'restaurant',
            icon: 'ðŸ¥˜',
            openingHours: { open: 11, close: 22 },
            visitDuration: 60,
            cuisine: 'moroccan',
            priceRange: '$',
            description: 'Authentic, no-nonsense tagines right on the square.',
            tips: 'No reservations. Terrace has great view.'
        },
        {
            id: 'dest_201',
            name: 'Le Salama ðŸ¸',
            lat: 31.6260, lng: -7.9880,
            type: 'restaurant',
            icon: 'ðŸ¸',
            openingHours: { open: 12, close: 0 },
            visitDuration: 90,
            cuisine: 'fusion',
            priceRange: '$$$',
            alcoholServed: true,
            description: 'Colonial style, happy hour, belly dancers.',
            tips: 'Good for a drink (alcohol served). Touristy but fun.'
        },
        {
            id: 'dest_202',
            name: 'CafÃ© des Ã‰pices â˜•',
            lat: 31.6293, lng: -7.9868,
            type: 'restaurant',
            icon: 'â˜•',
            openingHours: { open: 9, close: 22 },
            visitDuration: 60,
            cuisine: 'fusion',
            priceRange: '$$',
            description: 'Iconic cafe, rooftop terrace, camel burgers',
            tips: 'Good wifi. Weekly storytelling nights.'
        },
        {
            id: 'dest_203',
            name: 'Nomad ðŸ½ï¸',
            lat: 31.6302, lng: -7.9862,
            type: 'restaurant',
            icon: 'ðŸ½ï¸',
            openingHours: { open: 12, close: 23 },
            visitDuration: 75,
            cuisine: 'modern_moroccan',
            priceRange: '$$',
            alcoholServed: false,
            reservationRequired: true,
            priorityScore: 9,
            description: 'Modern Moroccan. Sunset terrace is most contested real estate in the Medina.',
            tips: 'BOOK WEEKS AHEAD for terrace edge at sunset. NO alcohol served.'
        },
        {
            id: 'dest_204',
            name: 'Al Fassia ðŸ¥˜',
            lat: 31.6368, lng: -8.0122,
            type: 'restaurant',
            icon: 'ðŸ¥˜',
            openingHours: { open: 12, close: 14.5, dinnerOpen: 19, dinnerClose: 22 },
            visitDuration: 90,
            cuisine: 'moroccan',
            priceRange: '$$$',
            alcoholServed: false,
            reservationRequired: true,
            priorityScore: 9,
            description: 'Women-run cooperative. Famous for Mechoui (lamb shoulder).',
            tips: 'CRITICAL: Mechoui must be PRE-ORDERED 24h ahead or it sells out. Reservations essential.'
        },
        {
            id: 'dest_205',
            name: 'Terrasse des Ã‰pices ðŸŒ…',
            lat: 31.6305,
            lng: -7.9863,
            type: 'restaurant',
            icon: 'ðŸŒ…',
            openingHours: { open: 10, close: 23 },
            visitDuration: 60,
            cuisine: 'moroccan',
            priceRange: '$$',
            description: 'Rooftop views over the medina',
            tips: 'Come for mint tea and sunset.'
        },
        {
            id: 'dest_206',
            name: 'Fine Mama ðŸ²',
            lat: 31.6256,
            lng: -7.9890,
            type: 'restaurant',
            icon: 'ðŸ²',
            openingHours: { open: 12, close: 22 },
            visitDuration: 45,
            cuisine: 'moroccan',
            priceRange: '$',
            description: 'Traditional food, safe hygiene, rooftop',
            tips: 'Good first meal. Safe landing spot.'
        },
        {
            id: 'dest_207',
            name: 'CafÃ© de France â˜•',
            lat: 31.6260, lng: -7.9890,
            type: 'restaurant',
            icon: 'â˜•',
            openingHours: { open: 8, close: 23 },
            visitDuration: 30,
            cuisine: 'cafe',
            priceRange: '$',
            alcoholServed: false,
            priorityScore: 8,
            description: 'The "View Tax". Poor food, indifferent service, but THE Jemaa el-Fnaa view.',
            tips: 'USE STRICTLY AS PHOTO STOP. Buy a mint tea (the "View Tax"), spend 30 mins on the upper terrace at sunset, then leave to eat elsewhere.'
        },
        {
            id: 'dest_208',
            name: 'Kasbah CafÃ© ðŸ¥—',
            lat: 31.6175,
            lng: -7.9890,
            type: 'restaurant',
            icon: 'ðŸ¥—',
            openingHours: { open: 9, close: 22 },
            visitDuration: 60,
            cuisine: 'moroccan',
            priceRange: '$$',
            description: 'Terrace facing the mosque',
            tips: 'Fair prices, good lunch spot near tombs.'
        },
        {
            id: 'dest_209',
            name: 'Amal Training Centre ðŸ²',
            lat: 31.6380,
            lng: -8.0100,
            type: 'restaurant',
            icon: 'ðŸ²',
            openingHours: { open: 12, close: 15 },
            visitDuration: 60,
            cuisine: 'moroccan',
            priceRange: '$',
            description: 'Non-profit training centre, excellent food',
            tips: 'Lunch only. Book Fridays for couscous.'
        },
        {
            id: 'dest_210',
            name: 'Chez Lamine ðŸ¥©',
            lat: 31.6270, lng: -7.9880,
            type: 'restaurant',
            icon: 'ðŸ¥©',
            openingHours: { open: 11, close: 15 }, // LUNCH ONLY
            visitDuration: 45,
            cuisine: 'mechoui',
            priceRange: '$$',
            priorityScore: 8,
            description: 'LUNCH-ONLY. Mechoui Alley institution. Tangia and slow-roasted lamb.',
            tips: 'TIMING CRITICAL: Mechoui roasted in the morning. Best cuts gone by 14:00. NOT a dinner destination. Go to permanent shop, not square stalls.'
        },
        {
            id: 'dest_211',
            name: 'Dar El Bacha (Bacha Coffee) â˜•',
            lat: 31.6320, lng: -7.9900,
            type: 'restaurant',
            icon: 'â˜•',
            openingHours: { open: 10, close: 18 },
            visitDuration: 90,
            cuisine: 'cafe',
            priceRange: '$$$',
            priorityScore: 9,
            queueLatency: 180, // 1.5-3+ hours typical
            thermalRefuge: true,
            description: 'The most "viral" venue. EXTREME wait times (1.5-3 hours).',
            tips: 'THE MUSEUM HACK: Pay museum fee (60 MAD) at the SEPARATE museum entrance (no line). Enter complex. Put name on coffee list with maÃ®tre d\'. TOUR THE MUSEUM while you wait. Converts dead wait into cultural activity.'
        },
        {
            id: 'dest_212',
            name: 'Kosybar ðŸ¸',
            lat: 31.6200,
            lng: -7.9850,
            type: 'restaurant',
            icon: 'ðŸ¸',
            openingHours: { open: 12, close: 24 },
            visitDuration: 90,
            cuisine: 'international',
            priceRange: '$$$',
            description: 'Sunset views over Storks',
            tips: 'Golden hour spot. Sushi available.'
        },
        {
            id: 'dest_213',
            name: 'La Trattoria ðŸ',
            lat: 31.6360,
            lng: -8.0110,
            type: 'restaurant',
            icon: 'ðŸ',
            openingHours: { open: 19, close: 23 },
            visitDuration: 90,
            cuisine: 'italian',
            priceRange: '$$$',
            description: 'Romantic poolside dining',
            tips: 'Dinner HQ. Reservation mandatory.'
        }
    ],
    experiences: [
        {
            id: 'dest_301',
            name: 'Hammam de la Rose ðŸ§–â€â™€ï¸',
            lat: 31.6267,
            lng: -7.9847,
            type: 'hammam',
            icon: 'ðŸ§–â€â™€ï¸',
            openingHours: { open: 9, close: 20 },
            visitDuration: 120,
            bestTime: 'afternoon',
            ticketPrice: 250,
            description: 'Traditional bathhouse experience',
            tips: 'Book treatments in advance. Bring swimwear.'
        },
        {
            id: 'dest_302',
            name: 'Cooking Class (La Maison Arabe) ðŸ‘¨â€ðŸ³',
            lat: 31.6298,
            lng: -7.9915,
            type: 'class',
            icon: 'ðŸ‘¨â€ðŸ³',
            openingHours: { open: 10, close: 14 },
            visitDuration: 180,
            bestTime: 'morning',
            ticketPrice: 500,
            description: 'Learn to cook tagine and couscous',
            tips: 'Book 48 hours ahead. Includes market visit.'
        },
        {
            id: 'dest_303',
            name: 'Quad Biking (Palmeraie) ðŸï¸',
            lat: 31.6692, lng: -7.9512,
            type: 'activity',
            icon: 'ðŸï¸',
            openingHours: { open: 9, close: 18 },
            visitDuration: 180,
            bestTime: 'morning',
            ticketPrice: 400,
            priorityScore: 6,
            avoidTime: [12, 16], // Heat + dust stifling
            thermalRisk: 'HIGH',
            description: 'ENVIRONMENTAL WARNING: Palmeraie is semi-arid scrubland, not a lush jungle. Extremely dusty.',
            tips: 'MANDATORY GEAR: Sunglasses + scarf (often provided). Heat + dust combo is stifling in summer.'
        },
        {
            id: 'dest_304',
            name: 'Hot Air Balloon ðŸŽˆ',
            lat: 31.6000, lng: -8.0500,
            type: 'activity',
            icon: 'ðŸŽˆ',
            openingHours: { open: 4, close: 11 }, // Total logistical footprint
            visitDuration: 300, // 5 HOURS total
            bestTime: 'sunrise',
            ticketPrice: 2000,
            priorityScore: 10,
            description: 'Logistically Heavy. Flight is 1h, but total commitment is 5 HOURS.',
            tips: 'TIME COST WARNING: Pickup 04:00-05:00 AM. Return 10-11 AM. This DELETES your morning. Clients return tired. DO NOT schedule heavy souk tour immediately after. Follow with pool or leisurely lunch.'
        },
        {
            id: 'dest_305',
            name: 'Hammam Mouassine (Historic) ðŸ›',
            lat: 31.6290, lng: -7.9860,
            type: 'hammam',
            icon: 'ðŸ›',
            openingHours: { open: 9, close: 21 },
            visitDuration: 90,
            bestTime: 'any',
            ticketPrice: 150,
            priorityScore: 8,
            experienceType: 'authentic',
            description: 'Dating to 1562. AUTHENTIC public bathhouse, NOT a spa.',
            tips: 'CULTURAL ADVISORY: Communal nudity (gender-separated). Vigorous scrubbing by attendant. Bucket-washing. Intense and authentic. For "adventurers," not luxury seekers. Bring own soap/towel or buy there.'
        },
    ],
    dayTrips: [
        {
            id: 'dest_401',
            name: 'Ourika Valley ðŸ”ï¸',
            lat: 31.3658,
            lng: -7.7969,
            type: 'daytrip',
            icon: 'ðŸ”ï¸',
            openingHours: { open: 0, close: 24 },
            visitDuration: 360,
            bestTime: 'morning',
            description: 'Atlas mountains, waterfalls, Berber villages',
            tips: 'Hire a driver. Best in spring/summer.'
        },
        {
            id: 'dest_402',
            name: 'Essaouira ðŸŒŠ',
            lat: 31.5086,
            lng: -9.7595,
            type: 'daytrip',
            icon: 'ðŸŒŠ',
            openingHours: { open: 0, close: 24 },
            visitDuration: 600,
            bestTime: 'full_day',
            description: 'Coastal town, blue boats, windsurfing',
            tips: '2.5 hour drive. Stay overnight if possible.'
        },
        {
            id: 'dest_403',
            name: 'Ait Benhaddou ðŸŽ¬',
            lat: 31.0472,
            lng: -7.1299,
            type: 'daytrip',
            icon: 'ðŸŽ¬',
            openingHours: { open: 0, close: 24 },
            visitDuration: 480,
            bestTime: 'full_day',
            description: 'UNESCO kasbah, Game of Thrones filming location',
            tips: '3 hour drive each way. Very hot in summer.'
        }
    ]
};

